/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1031:function(t,e,o){"use strict";o(23);e.a=function(t){return new Promise((function(e,o){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){return e(r.result)},r.onerror=function(t){return o(t)}}))}},1134:function(t,e,o){var content=o(2195);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(13).default)("6511c69d",content,!0,{sourceMap:!1})},2194:function(t,e,o){"use strict";var r=o(1134);o.n(r).a},2195:function(t,e,o){(e=o(12)(!1)).push([t.i,".color img{border-radius:.25rem}.color .pickr{display:inline-block;vertical-align:text-bottom}.color .pickr button{width:1.25rem;height:1.25rem;border:.0625rem solid #dcdfe6}.color .img-colors .img-color div:not(.nya-subtitle){padding:.625rem;display:inline-block;color:#fff;text-shadow:.125rem .125rem .125rem rgba(0,0,0,.2)}.color .img-colors .img-palette{margin-top:.9375rem}.color .img-colors .img-palette ul{padding:0;margin:0}.color .img-colors .img-palette li{margin:0;display:inline-block;font-size:1rem;box-sizing:border-box;padding:.625rem;text-align:center;color:#fff;text-shadow:.125rem .125rem .125rem rgba(0,0,0,.2)}@media (max-width:850px){.color .img-colors .img-palette li{width:30%}}.color .preview{font-size:0}.color .preview img{width:18.75rem;max-width:100%}.color .copy,.color .img-palette li,.color .nya-list li{cursor:pointer}",""]),t.exports=e},2668:function(t,e,o){"use strict";o.r(e);o(131),o(132),o(23);var r=o(2188),n=o.n(r),c=(o(420),function(image){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=image.width,this.height=this.canvas.height=image.height,this.context.drawImage(image,0,0,this.width,this.height)});c.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},c.prototype.update=function(t){this.context.putImageData(t,0,0)},c.prototype.getPixelCount=function(){return this.width*this.height},c.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},c.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var l=function(){};if(l.prototype.getColor=function(t,e){return this.getPalette(t,5,e)[0]},l.prototype.getPalette=function(t,e,o){(void 0===e||e<2||e>256)&&(e=10),(void 0===o||o<1)&&(o=10);for(var r,n,g,b,image=new c(t),l=image.getImageData().data,h=image.getPixelCount(),v=[],i=0;i<h;i+=o)n=l[(r=4*i)+0],g=l[r+1],b=l[r+2],l[r+3]>=125&&(n>250&&g>250&&b>250||v.push([n,g,b]));var d=f.quantize(v,e),m=d?d.palette():null;return image.removeCanvas(),m},l.prototype.getColorFromUrl=function(t,e,o){var r=document.createElement("img"),n=this;r.addEventListener("load",(function(){var c=n.getPalette(r,5,o)[0];e(c,t)})),r.src=t},l.prototype.getImageData=function(t,e){var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer",o.onload=function(){if(200==this.status){var t=new Uint8Array(this.response);i=t.length;for(var o=new Array(i),i=0;i<t.length;i++)o[i]=String.fromCharCode(t[i]);var data=o.join(""),r=window.btoa(data);e("data:image/png;base64,"+r)}},o.send()},l.prototype.getColorAsync=function(t,e,o){var r=this;this.getImageData(t,(function(t){var n=document.createElement("img");n.addEventListener("load",(function(){var t=r.getPalette(n,5,o)[0];e(t,this)})),n.src=t}))},!h)var h={map:function(t,e){var o={};return e?t.map((function(t,i){return o.index=i,e.call(o,t)})):t.slice()},naturalOrder:function(a,b){return a<b?-1:a>b?1:0},sum:function(t,e){var o={};return t.reduce(e?function(p,t,i){return o.index=i,p+e.call(o,t)}:function(p,t){return p+t},0)},max:function(t,e){return Math.max.apply(null,e?h.map(t,e):t)}};var f=function(){function t(t,g,b){return(t<<10)+(g<<5)+b}function e(t){var e=[],o=!1;function r(){e.sort(t),o=!0}return{push:function(t){e.push(t),o=!1},peek:function(t){return o||r(),void 0===t&&(t=e.length-1),e[t]},pop:function(){return o||r(),e.pop()},size:function(){return e.length},map:function(t){return e.map(t)},debug:function(){return o||r(),e}}}function o(t,e,o,r,n,c,l){this.r1=t,this.r2=e,this.g1=o,this.g2=r,this.b1=n,this.b2=c,this.histo=l}function r(){this.vboxes=new e((function(a,b){return h.naturalOrder(a.vbox.count()*a.vbox.volume(),b.vbox.count()*b.vbox.volume())}))}function n(e,o){if(o.count()){var r=o.r2-o.r1+1,n=o.g2-o.g1+1,c=o.b2-o.b1+1,l=h.max([r,n,c]);if(1==o.count())return[o.copy()];var i,f,v,d,m=0,w=[],y=[];if(l==r)for(i=o.r1;i<=o.r2;i++){for(d=0,f=o.g1;f<=o.g2;f++)for(v=o.b1;v<=o.b2;v++)d+=e[t(i,f,v)]||0;m+=d,w[i]=m}else if(l==n)for(i=o.g1;i<=o.g2;i++){for(d=0,f=o.r1;f<=o.r2;f++)for(v=o.b1;v<=o.b2;v++)d+=e[t(f,i,v)]||0;m+=d,w[i]=m}else for(i=o.b1;i<=o.b2;i++){for(d=0,f=o.r1;f<=o.r2;f++)for(v=o.g1;v<=o.g2;v++)d+=e[t(f,v,i)]||0;m+=d,w[i]=m}return w.forEach((function(t,i){y[i]=m-t})),C(l==r?"r":l==n?"g":"b")}function C(t){var e,r,n,c,l,h=t+"1",f=t+"2",v=0;for(i=o[h];i<=o[f];i++)if(w[i]>m/2){for(n=o.copy(),c=o.copy(),l=(e=i-o[h])<=(r=o[f]-i)?Math.min(o[f]-1,~~(i+r/2)):Math.max(o[h],~~(i-1-e/2));!w[l];)l++;for(v=y[l];!v&&w[l-1];)v=y[--l];return n[f]=l,c[h]=n[f]+1,[n,c]}}}return o.prototype={volume:function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(e){var o=this.histo;if(!this._count_set||e){var i,r,n,c=0;for(i=this.r1;i<=this.r2;i++)for(r=this.g1;r<=this.g2;r++)for(n=this.b1;n<=this.b2;n++)c+=o[t(i,r,n)]||0;this._count=c,this._count_set=!0}return this._count},copy:function(){return new o(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(e){var o=this.histo;if(!this._avg||e){var r,i,n,c,l=0,h=0,f=0,v=0;for(i=this.r1;i<=this.r2;i++)for(n=this.g1;n<=this.g2;n++)for(c=this.b1;c<=this.b2;c++)l+=r=o[t(i,n,c)]||0,h+=r*(i+.5)*8,f+=r*(n+.5)*8,v+=r*(c+.5)*8;this._avg=l?[~~(h/l),~~(f/l),~~(v/l)]:[~~(8*(this.r1+this.r2+1)/2),~~(8*(this.g1+this.g2+1)/2),~~(8*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(t){var e=t[0]>>3,o=t[1]>>3,r=t[2]>>3;return e>=this.r1&&e<=this.r2&&o>=this.g1&&o<=this.g2&&r>=this.b1&&r<=this.b2}},r.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map((function(t){return t.color}))},size:function(){return this.vboxes.size()},map:function(t){for(var e=this.vboxes,i=0;i<e.size();i++)if(e.peek(i).vbox.contains(t))return e.peek(i).color;return this.nearest(t)},nearest:function(t){for(var e,o,r,n=this.vboxes,i=0;i<n.size();i++)((o=Math.sqrt(Math.pow(t[0]-n.peek(i).color[0],2)+Math.pow(t[1]-n.peek(i).color[1],2)+Math.pow(t[2]-n.peek(i).color[2],2)))<e||void 0===e)&&(e=o,r=n.peek(i).color);return r},forcebw:function(){var t=this.vboxes;t.sort((function(a,b){return h.naturalOrder(h.sum(a.color),h.sum(b.color))}));var e=t[0].color;e[0]<5&&e[1]<5&&e[2]<5&&(t[0].color=[0,0,0]);var o=t.length-1,r=t[o].color;r[0]>251&&r[1]>251&&r[2]>251&&(t[o].color=[255,255,255])}},{quantize:function(c,l){if(!c.length||l<2||l>256)return!1;var f=function(e){var o,r,n,c,l=new Array(32768);return e.forEach((function(e){r=e[0]>>3,n=e[1]>>3,c=e[2]>>3,o=t(r,n,c),l[o]=(l[o]||0)+1})),l}(c);f.forEach((function(){0}));var v=function(t,e){var r,n,c,l=1e6,h=0,f=1e6,v=0,d=1e6,m=0;return t.forEach((function(t){r=t[0]>>3,n=t[1]>>3,c=t[2]>>3,r<l?l=r:r>h&&(h=r),n<f?f=n:n>v&&(v=n),c<d?d=c:c>m&&(m=c)})),new o(l,h,f,v,d,m,e)}(c,f),d=new e((function(a,b){return h.naturalOrder(a.count(),b.count())}));function m(t,e){for(var o,r=1,c=0;c<1e3;)if((o=t.pop()).count()){var l=n(f,o),h=l[0],v=l[1];if(!h)return;if(t.push(h),v&&(t.push(v),r++),r>=e)return;if(c++>1e3)return}else t.push(o),c++}d.push(v),m(d,.75*l);for(var w=new e((function(a,b){return h.naturalOrder(a.count()*a.volume(),b.count()*b.volume())}));d.size();)w.push(d.pop());m(w,l-w.size());for(var y=new r;w.size();)y.push(w.pop());return y}}}(),v=l,d=o(2189),m=o.n(d),w=o(1031),y={name:"Color",head:function(){return this.$store.state.currentTool.head},data:function(){return{color:"#249ffd",filename:null,preview:"",imgColor:{color:"",palette:""},loading:!1,colorthief:new v,pickr:null,mobile:""}},computed:{handleColor:function(){var t=n()(this.color);return{"RGB(A)":t.toString("rgb").toUpperCase(),HEX6:t.toHexString().toUpperCase(),HEX8:t.toHex8String().toUpperCase(),"HSL(A)":t.toString("hsl").toUpperCase(),"HSV(A)":t.toString("hsv").toUpperCase()}}},mounted:function(){window.innerWidth>950&&(this.hide=!1),this.$store.state.isMobile?o(2190):o(2192),this.initPickr()},methods:{initPickr:function(){var t=this;this.pickr=m.a.create({el:this.$refs.colorPicker,theme:this.$store.state.isMobile?"monolith":"classic",default:this.color,components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,hsla:!0,hsva:!0,cmyk:!0,input:!0,clear:!0,save:!0}},position:"right-end"}),this.pickr.on("save",(function(e){t.color=e?e.toRGBA().toString(2):""}))},copyColor:function(t){var e=this;this.$copyText(t).then((function(){e.$message.success("复制成功")}),(function(){e.$message.error("复制失败，请手动选择复制")}))},reset:function(){this.color="#249ffd",this.pickr.setColor("#249ffd"),this.preview="",this.imgColor={color:"",palette:""},this.colorthief=new v},handleChange:function(t){var e=this;if(this.loading)return!1;var o=t.target.files;if(!o.length)return!1;var r=o[0];this.loading=!0,this.reset(),Object(w.a)(r).then((function(t){e.preview=t;var img=new Image;img.onload=function(){var t=e.colorthief.getPalette(img).map((function(t){return n()("rgb(".concat(t.toString(),")")).toHexString()})),o=n()("rgb(".concat(e.colorthief.getColor(img).toString(),")")).toHexString();e.imgColor.palette=t,e.imgColor.color=o,e.color=o,e.pickr.setColor(o),e.loading=!1},img.src=e.preview}))}}},C=(o(2194),o(5)),component=Object(C.a)(y,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"color"},[o("nya-container",{attrs:{title:"颜色转换"}},[o("el-tooltip",{attrs:{effect:"dark",content:"选择颜色",placement:"top"}},[o("div",{staticStyle:{display:"inline-block"}},[o("div",{staticClass:"nya-subtitle inline-title"},[t._v("\n                    颜色选择器\n                ")]),o("div",{ref:"colorPicker"})])]),o("hr"),o("div",{staticClass:"nya-subtitle"},[t._v("\n            提取图片主色\n        ")]),o("el-input",{staticClass:"mb-15",attrs:{type:"file",placeholder:t.filename?t.filename.replace(/C:\\fakepath\\/,""):"点击这里上传文件",accept:"image/*",clearable:""},on:{clear:t.reset},nativeOn:{change:function(e){return t.handleChange(e)}},model:{value:t.filename,callback:function(e){t.filename=e},expression:"filename"}}),t.preview?o("div",{staticClass:"preview"},[o("div",{staticClass:"nya-subtitle mt-15"},[t._v("\n                预览\n            ")]),o("img",{attrs:{src:t.preview,alt:"preview"}})]):t._e(),t.preview?o("div",{staticClass:"img-colors"},[o("div",{staticClass:"img-color"},[o("div",{staticClass:"nya-subtitle mt-15"},[t._v("\n                    主色\n                ")]),o("el-tooltip",{staticClass:"copy",attrs:{effect:"dark",content:"复制主色",placement:"bottom"}},[o("div",{style:{"background-color":t.imgColor.color},on:{click:function(e){return t.copyColor(t.imgColor.color)}}},[t._v("\n                        "+t._s(t.imgColor.color)+"\n                    ")])])],1),o("div",{staticClass:"img-palette"},[o("div",{staticClass:"nya-subtitle"},[t._v("\n                    调色盘\n                ")]),o("ul",t._l(t.imgColor.palette,(function(e,r){return o("el-tooltip",{key:r,attrs:{effect:"dark",content:"复制 HEX 值",placement:"bottom"}},[o("li",{style:{"background-color":e},on:{click:function(o){return t.copyColor(e)}}},[t._v("\n                            "+t._s(e)+"\n                        ")])])})),1)])]):t._e()],1),o("nya-container",{attrs:{title:"结果"}},[o("ul",{staticClass:"nya-list"},t._l(t.handleColor,(function(e,r){return o("li",{key:r,on:{click:function(o){return t.copyColor(e)}}},[o("el-tooltip",{attrs:{effect:"dark",content:"点击复制："+r,placement:"right"}},[o("div",{staticStyle:{display:"inline-block"}},[o("b",[t._v(t._s(r)+"：")]),o("span",[t._v(t._s(e))])])])],1)})),0)])],1)}),[],!1,null,null,null);e.default=component.exports}}]);