(window.webpackJsonp=window.webpackJsonp||[]).push([[131],{1061:function(t,e,n){"use strict";n(23);e.a={upload:function(t,e,n){var o=n.format,l=n.cnapi,r=n.metaData;return new Promise((function(n,c){var d=new FormData;d.append("image",e),t.$axios.post("/upload_image",d,{cnapi:l,params:{format:o||"webp"}}).then((function(t){var e=l?"https://dogcloud-mikutools-cnapi.cdn.hatsune.tech":"https://dogcloud-mikutools-api.cdn.hatsune.tech",o=new URL(t.data.data,e),image=new Image;image.src=o,image.onload=function(){n(r?{url:o,e:t}:o)}})).catch(c)}))}}},1204:function(t,e,n){var content=n(2427);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(13).default)("d5827156",content,!0,{sourceMap:!1})},2426:function(t,e,n){"use strict";var o=n(1204);n.n(o).a},2427:function(t,e,n){(e=n(12)(!1)).push([t.i,".set-bg .inputbtn,.set-bg .nya-subtitle{margin-top:.9375rem}.set-bg .preview{display:block;max-height:12.5rem;border:.0625rem solid var(--color-text-placeholder)}",""]),t.exports=e},2664:function(t,e,n){"use strict";n.r(e);var o=n(1061),l={name:"SetBackground",data:function(){return{setting:{bg:{}},upload:{n:"",uploadData:null,file:"",loading:!1}}},mounted:function(){var t=this;setTimeout((function(){var e=t.$store.state.setting;t.setting=e,t.upload.uploadData=e.bg.upload}),0)},methods:{handleChange:function(t,e){this.$store.commit("SET_STORE",{key:t,value:e})},handleUploadChange:function(t){var e=t.target.files;if(!e.length)return!1;var n=e[0];n.size/1024/1024>5?(this.upload.n="",this.$notify.error({title:"上传失败",message:"请选择大小在5M以内的图片"})):this.upload.file=n},uploadImg:function(){var t=this;return!!this.upload.file&&(!this.upload.loading&&(this.upload.uploadData=null,this.upload.loading=!0,void o.a.upload(this,this.upload.file,{format:"webp"}).then((function(e){t.upload.uploadData=e,t.setUploadBg()})).catch((function(e){t.$notify.error({title:"上传失败",message:e}),t.upload.loading=!1}))))},setUploadBg:function(){this.$store.commit("SET_STORE",{key:"setting.bg.upload",value:this.upload.uploadData}),this.upload.loading=!1},removeBg:function(){this.$store.commit("SET_STORE",{key:"setting.bg.upload",value:{url:""}}),this.upload.uploadData=null}}},r=(n(2426),n(5)),c=Object(r.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nya-container",{staticClass:"set-bg",attrs:{title:"背景图片"}},[n("div",{staticClass:"radio-group"},[n("el-radio-group",{on:{change:function(e){return t.handleChange("setting.bg.type",e)}},model:{value:t.setting.bg.type,callback:function(e){t.$set(t.setting.bg,"type",e)},expression:"setting.bg.type"}},[n("el-radio",{attrs:{label:"none"}},[t._v("\n                无\n            ")]),n("el-radio",{attrs:{label:"anime"}},[t._v("\n                随机动漫图片\n            ")]),n("el-radio",{attrs:{label:"bing"}},[t._v("\n                必应每日壁纸\n            ")]),n("el-radio",{attrs:{label:"custom"}},[t._v("\n                自定义来源\n            ")]),n("el-radio",{attrs:{label:"upload"}},[t._v("\n                上传壁纸\n            ")])],1)],1),t.setting.bg?n("div",{directives:[{name:"show",rawName:"v-show",value:"custom"===t.$store.state.setting.bg.type,expression:"$store.state.setting.bg.type === 'custom'"}]},[n("div",{staticClass:"nya-subtitle"},[t._v("\n            输入壁纸链接\n        ")]),n("el-input",{attrs:{placeholder:t.$store.state.env.url+"/icon.png",clearable:""},on:{change:function(e){return t.handleChange("setting.bg.customUrl",e.target.value)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleChange("setting.bg.customUrl",e.target.value)}},model:{value:t.setting.bg.customUrl,callback:function(e){t.$set(t.setting.bg,"customUrl",e)},expression:"setting.bg.customUrl"}})],1):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:"upload"===t.$store.state.setting.bg.type,expression:"$store.state.setting.bg.type === 'upload'"}]},[n("el-input",{staticClass:"mt-15",attrs:{type:"file",accept:"image/*",disabled:t.upload.loading,placeholder:t.upload.n?t.upload.n.replace(/C:\\fakepath\\/,""):"点击这里上传文件",clearable:""},on:{clear:function(e){t.upload.file=null}},nativeOn:{change:function(e){return t.handleUploadChange(e)}},model:{value:t.upload.n,callback:function(e){t.$set(t.upload,"n",e)},expression:"upload.n"}},[n("el-button",{attrs:{slot:"append",loading:t.upload.loading},on:{click:t.uploadImg},slot:"append"},[t._v("\n                "+t._s(t.upload.loading?"设置中":"设置")+"\n            ")])],1),t.upload.uploadData?n("div",[n("div",{staticClass:"nya-subtitle"},[t._v("\n                预览(当前背景)\n            ")]),n("img",{staticClass:"preview mb-15",attrs:{src:t.upload.uploadData,alt:"preview"}}),n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.setting.bg,expression:"$store.state.setting.bg"}],on:{click:t.removeBg}},[t._v("\n                移除背景\n            ")])],1):t._e()],1),n("div",{staticClass:"nya-subtitle inline-title"},[t._v("\n        元素半透明\n    ")]),n("el-switch",{on:{change:function(e){return t.handleChange("setting.bg.transparentEl",e)}},model:{value:t.setting.bg.transparentEl,callback:function(e){t.$set(t.setting.bg,"transparentEl",e)},expression:"setting.bg.transparentEl"}}),n("div",{staticClass:"nya-subtitle mb-0"},[t._v("\n        高斯模糊\n    ")]),n("el-slider",{attrs:{min:0,max:100},on:{change:function(e){return t.handleChange("setting.bg.blur",e)}},model:{value:t.setting.bg.blur,callback:function(e){t.$set(t.setting.bg,"blur",e)},expression:"setting.bg.blur"}}),n("div",{staticClass:"nya-subtitle mb-0 mt-0"},[t._v("\n        透明度\n    ")]),n("el-slider",{attrs:{min:1,max:100},on:{change:function(e){return t.handleChange("setting.bg.opacity",e)}},model:{value:t.setting.bg.opacity,callback:function(e){t.$set(t.setting.bg,"opacity",e)},expression:"setting.bg.opacity"}})],1)}),[],!1,null,null,null).exports,d=n(18),h=n.n(d),m={name:"Setting",head:function(){return this.$store.state.currentTool.head},components:{SetBackground:c},data:function(){return{syncIng:!1,setting:{}}},mounted:function(){var t=this;setTimeout((function(){t.setting=t.$store.state.setting}),0)},methods:{handleChange:function(t,e){this.$message.success("更新成功，部分设置需要刷新页面后生效"),this.$store.commit("SET_STORE",{key:t,value:e})},formatDate:function(t){return 0===t?"未同步过":h.a.unix(t).format("MM-DD HH:mm:ss")}}},v=Object(r.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"setting"},[n("SetBackground"),n("nya-container",{attrs:{title:"自定义 CSS"}},[n("el-input",{staticClass:"mb-15",attrs:{type:"textarea",autosize:{minRows:5,maxRows:8},placeholder:".navbar{display: none}"},on:{keydown:function(t){t.preventDefault()},change:function(e){return t.handleChange("setting.css",e.target?e.target.value:e)}},model:{value:t.setting.css,callback:function(e){t.$set(t.setting,"css",e)},expression:"setting.css"}})],1),n("nya-container",{attrs:{title:"自定义 JS"}},[n("el-input",{staticClass:"mb-15",attrs:{type:"textarea",autosize:{minRows:5,maxRows:8},placeholder:"alert('欢迎使用 MikuTools')"},on:{keydown:function(t){t.preventDefault()},change:function(e){return t.handleChange("setting.js",e.target?e.target.value:e)}},model:{value:t.setting.js,callback:function(e){t.$set(t.setting,"js",e)},expression:"setting.js"}})],1),n("nya-container",{attrs:{title:"其他设置"}},[n("el-checkbox",{on:{change:function(e){return t.handleChange("setting.autoDarkMode",e)}},model:{value:t.setting.autoDarkMode,callback:function(e){t.$set(t.setting,"autoDarkMode",e)},expression:"setting.autoDarkMode"}},[t._v("\n            自动切换夜间模式\n        ")]),n("el-checkbox",{on:{change:function(e){return t.handleChange("setting.showWeather",e)}},model:{value:t.setting.showWeather,callback:function(e){t.$set(t.setting,"showWeather",e)},expression:"setting.showWeather"}},[t._v("\n            显示天气\n        ")]),n("el-checkbox",{on:{change:function(e){return t.handleChange("setting.showConsole",e)}},model:{value:t.setting.showConsole,callback:function(e){t.$set(t.setting,"showConsole",e)},expression:"setting.showConsole"}},[t._v("\n            移动端显示 Console\n        ")]),n("el-checkbox",{on:{change:function(e){return t.handleChange("setting.hideNotice",e)}},model:{value:t.setting.hideNotice,callback:function(e){t.$set(t.setting,"hideNotice",e)},expression:"setting.hideNotice"}},[t._v("\n            隐藏公告\n        ")]),n("el-checkbox",{on:{change:function(e){return t.handleChange("setting.hideCategory",e)}},model:{value:t.setting.hideCategory,callback:function(e){t.$set(t.setting,"hideCategory",e)},expression:"setting.hideCategory"}},[t._v("\n            隐藏分类\n        ")]),n("el-checkbox",{on:{change:function(e){return t.handleChange("setting.inNewTab",e)}},model:{value:t.setting.inNewTab,callback:function(e){t.$set(t.setting,"inNewTab",e)},expression:"setting.inNewTab"}},[t._v("\n            新标签打开工具\n        ")]),n("el-checkbox",{on:{change:function(e){return t.handleChange("setting.transition",e)}},model:{value:t.setting.animations,callback:function(e){t.$set(t.setting,"animations",e)},expression:"setting.animations"}},[t._v("\n            启用过渡动画\n        ")])],1)],1)}),[],!1,null,null,null);e.default=v.exports}}]);